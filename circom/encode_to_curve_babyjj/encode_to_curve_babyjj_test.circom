pragma circom 2.2.2;

include "encode_to_curve_babyjj.circom";

template Tester() {
    signal input in;
    signal output out;

    signal hash_to_field_test1 <== HashToField()(in);
    hash_to_field_test1 === 0x2e5c8c8ff53da47080c341f261d1a10c1d54f6650b90bbed9dd30198ca1256b3;


    signal map_to_curve_elligator2_kat0[2] <== MapToCurveElligator2()(hash_to_field_test1);

    signal map_to_curve_elligator2_kat1[2] <== MapToCurveElligator2()(0);

    signal map_to_curve_elligator2_kat2[2] <== MapToCurveElligator2()(1);

    signal map_to_curve_elligator2_kat3[2] <== MapToCurveElligator2()(2);

    signal map_to_curve_elligator2_kat4[2] <== MapToCurveElligator2()(-1);
    signal map_to_curve_elligator2_kat5[2] <== MapToCurveElligator2()(-2);
    signal map_to_curve_elligator2_kat6[2] <== MapToCurveElligator2()(0x42);
    signal map_to_curve_elligator2_kat7[2] <== MapToCurveElligator2()(-0x42);

    map_to_curve_elligator2_kat0 === [175237875522834448155549773453859181418677905226545111199128371026771239667, 21093709385442275369448476304363512163107465754712817413145095532362233379686];
    map_to_curve_elligator2_kat1 === [0, 0];
    map_to_curve_elligator2_kat2 === [14592161914559516814830937163504850059032242933610689562465469457717205523163,19295415032761905889642384658646365873112747456829196877313925589830351592100];

    map_to_curve_elligator2_kat3 === [19803648312616487105841986150470867937258043981328792977631708549759064668703,13727573273142503991283543845260329070609971662849521911601331219358639896120];

    map_to_curve_elligator2_kat4 === [14592161914559516814830937163504850059032242933610689562465469457717205523163,19295415032761905889642384658646365873112747456829196877313925589830351592100];
    map_to_curve_elligator2_kat5 === [19803648312616487105841986150470867937258043981328792977631708549759064668703,13727573273142503991283543845260329070609971662849521911601331219358639896120];
    map_to_curve_elligator2_kat6 === [10025118722256490042566004486235093718532596449132287710056162938583181008774,6933601652287022724841900404410569690280174658917481121509063082102518676195];
    map_to_curve_elligator2_kat7 === [10025118722256490042566004486235093718532596449132287710056162938583181008774,6933601652287022724841900404410569690280174658917481121509063082102518676195];


    
    signal rational_map_mont_to_twisted_edwards_kat0[2] <== RationalMapMontToTwistedEdwardsBabyJubJub()([175237875522834448155549773453859181418677905226545111199128371026771239667,794533486396999852797929440893762925440898645703216930553108654213575115931]);
    signal rational_map_mont_to_twisted_edwards_kat1[2] <== RationalMapMontToTwistedEdwardsBabyJubJub()([0,0]);
    signal rational_map_mont_to_twisted_edwards_kat2[2] <== RationalMapMontToTwistedEdwardsBabyJubJub()([1,1]);
    signal rational_map_mont_to_twisted_edwards_kat3[2] <== RationalMapMontToTwistedEdwardsBabyJubJub()([-1,-1]);
    signal rational_map_mont_to_twisted_edwards_kat4[2] <== RationalMapMontToTwistedEdwardsBabyJubJub()([10648445053055756208483835589904638676661988556514516239690237683734442125505,4802517896840021410932810118091198914414923462543984062792492592398104141457]);
    signal rational_map_mont_to_twisted_edwards_kat5[2] <== RationalMapMontToTwistedEdwardsBabyJubJub()([13928434676296924924765127352011880387425691095468639662724784187564067377072,18211632101538598908289863877574746871320438727566408308565268994294879318468]);

    rational_map_mont_to_twisted_edwards_kat0 === [19749237763777877504811025958859187282736077178612498967835952987338546424382, 9825651499528233657748386613879383508828535951494059213535798845190111515722];
    rational_map_mont_to_twisted_edwards_kat1 === [0,1];
    rational_map_mont_to_twisted_edwards_kat2 === [1,0];
    rational_map_mont_to_twisted_edwards_kat3 === [0,1];
    rational_map_mont_to_twisted_edwards_kat4 === [9466255069464382829376229720059203306026642282376731717118956633769641656470,12172554837077650910888073060921814542100819213660500362167557566341089258409];
    rational_map_mont_to_twisted_edwards_kat5 === [2470881447391213781614504519959721958403589263638078742368987485649336225559,4390912069244256456195108556072778653261615640159852116224565554917053061197];
    out <== map_to_curve_elligator2_kat0[0];


    signal clear_cofactor_babyjubjub_kat0[2] <== ClearCoFactorBabyJubJub()([19749237763777877504811025958859187282736077178612498967835952987338546424382,9825651499528233657748386613879383508828535951494059213535798845190111515722]);
    signal clear_cofactor_babyjubjub_kat1[2] <== ClearCoFactorBabyJubJub()([19639628802331067714920142964194687338561819679258049812441592321105943536842, 11346329236507494865585709204927959305406795872019529850625216399990666158973]);
    signal clear_cofactor_babyjubjub_kat2[2] <== ClearCoFactorBabyJubJub()([8209398687764479338874622630135315686212707031708372733707065788681004290804, 7952524503094846254003139028504820220835142329118525005533786297154183575893]);

    clear_cofactor_babyjubjub_kat0 === [19639628802331067714920142964194687338561819679258049812441592321105943536842, 11346329236507494865585709204927959305406795872019529850625216399990666158973];    
    clear_cofactor_babyjubjub_kat1 === [8209398687764479338874622630135315686212707031708372733707065788681004290804, 7952524503094846254003139028504820220835142329118525005533786297154183575893];    
    clear_cofactor_babyjubjub_kat2 === [10873729373466187168732787656725114046976746925851753192500476549919102027549, 12798037779934295567578517080349860047505013996760633587201983316944729077251];    

    signal encode_e2e_kat0[2] <== EncodeToCurveBabyJubJub()(0);
    signal encode_e2e_kat1[2] <== EncodeToCurveBabyJubJub()(1);
    signal encode_e2e_kat2[2] <== EncodeToCurveBabyJubJub()(2);
    signal encode_e2e_kat3[2] <== EncodeToCurveBabyJubJub()(-1);
    signal encode_e2e_kat4[2] <== EncodeToCurveBabyJubJub()(-2);
    signal encode_e2e_kat5[2] <== EncodeToCurveBabyJubJub()(0x42);
    encode_e2e_kat0 === [20933827970802813890983825285326248243008219406120265623912040617116488051168, 19221830974981021604074333064965073057369542973805695443932626741929482323481];
    encode_e2e_kat1 === [158003743186178317583285349076672373866032857213932356251773095567170960213, 4814651661221091094003361804145731078627371241787264107209666662974858819435];
    encode_e2e_kat2 === [590035407490982777204546683671971250819163473412883717735623605641533212005, 21509782021198293148557887755012146227091104930155791537458800490097986032508];
    encode_e2e_kat3 === [1551705331698544401524786606720811740181943945870244569202198367044300364404, 20918696086212258109716309157665435087956178115434976279417465423469312201822];
    encode_e2e_kat4 === [12051513240185558784189387203648011096589057748042969898042260157253037231193, 16839428587369934621128818930710913075293841981260438881780795931293644464244];
    encode_e2e_kat5 === [5520721918672064917347280398526519562725607465061028485851804404263332149374, 15552952328295689847327188987393079505308628175404295821602016444687698081549];
}

component main = Tester();
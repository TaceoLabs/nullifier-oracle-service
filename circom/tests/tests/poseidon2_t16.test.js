const { wasm } = require("circom_tester");
const { expect } = require("chai");
const path = require("path");

describe("Poseidon2 t=16 kats", function () {
  this.timeout(10000);

  let circuit;
  before(async () => {
    circuit = await wasm(
      path.join(__dirname, "circuits/poseidon2_t16_test.circom"),
      { include: [path.join(__dirname, "../../poseidon2")] },
    );
    await circuit.loadConstraints();
  });

  it("kat0", async () => {
    const witness = await circuit.calculateWitness({ in: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15] }, true);
    await circuit.assertOut(witness, {
      out: [
        0x0fc2e6b758f493969e1d860f9a44ee3bdffdf796f382aa4ffb16fa4e9bcc333fn,
        0x0c118155a0dfeca3f91faf14a350511228ac33743be91249c6e0b3a635a50de4n,
        0x1a02b3a6571f22bb6392322d3f9f5de145b4f00bdf483072ce6188c30ba0f83dn,
        0x26631df6b2522ecde57413cd680ed590ded356e1c680f865f45be8eb960d1e06n,
        0x250ac4dfed40dc37bac9abe46f7bff3a80481d52a157ac80a1e5d39a5ed60e18n,
        0x17160980d8e7d9cb31addaf294cf047768bffd9fe433e8903b4ed262ee913f5bn,
        0x1d708a9f0995c2e0cd2f55e5dc795126f7191a0eb934ac8172bf54e520361ff6n,
        0x20721a18915e96e37e12c9697427f34d6a366787ea94ea65565c36813a0d77a3n,
        0x08671a9e58105eed9ac673249dcf22f08f098e3c6eb28f9eaa55d67d755972d0n,
        0x01e879484303c6d057128fbcc3a4222c779a62d3666df65d4e0b64c8031d7cc4n,
        0x239e2ce87955ebe19aaad000b38725b729f51175ab7d688f15d997edf0e3b7fcn,
        0x06be612f42b3ebdbade3fe199338c9118eb6b5fb760bda96e45443f130a8b2den,
        0x11b2c04b4eb9e4844e5ddbb19b56059a815ed5d69405ba51786961235d5f073cn,
        0x006da33e2d57616c0ffc855b48d225a1237c3d80fc7e6b6e73b74e162b85c8a8n,
        0x0ef50c2615882523c6c73a69b4371332a066b2dc4b9630f186db47e3bfca88c8n,
        0x0e2ceb1f8fde5f80be1f41bd239fabdc2f6133a6a98920a55c42891c3a925152n
      ],
    });
    await circuit.checkConstraints(witness);
  });

  it("kat1", async () => {
    const witness = await circuit.calculateWitness(
      {
        in: [
          0x2ef5bd70482d1d5bce16a04a5220175878dc715c51070672fd79df2f36fb719dn,
          0x015425a96665c5004e9210cf6828d8019c057cd587408a27347d951d9dffc2d9n,
          0x1551585c9c4cd84962ce750509aa7c10f6070167cf02f413b1ebb99b46070f9dn,
          0x13b3e781956e21bfa1ab9b729c8870cd6834165331261b613ed155bec20c705cn,
          0x1efcc38f5d29388649ac90a53f2f18199b3b85b18a817e0ecc35fc8bc0c8f935n,
          0x301c505d503072bf6273b63ddb8ab6decf288fe0ca24e01e9d29d1c2b445840fn,
          0x1d0f515363f3f1d7a730fa40ee5adfc9dbc64ee624f748578583724b9c950d4dn,
          0x08d0a79b8f7f9900e653719a0fa83eddea4cb60912ab072a7c53c5e06be06f57n,
          0x257634dc118a69195eba44a7d683b806b13b6954284c00df03fa6fec498d7136n,
          0x1c3a1e671b80722c3093704597f0682648d4ed2edf527c394437f83455c6dc9fn,
          0x2b9b5fa799f3e7e3b25f5789aea0ad85cf688df558df55cd5aa01e08ad61a0f3n,
          0x2976d9a19d3daaa5d4754b07212dd1790e1a2e792bb1f3f3c1fdf29cb9876a0cn,
          0x024e57dba7a40fcd9c055126821db288671ca25c7a2d331f0a44aafd281c420cn,
          0x2ace2b5e9b3840a1bf285ba01256a92c847585a0387d82959331e1ff831fe7ebn,
          0x095eee248104564b4123f8b16cd2e659a84ee02453ee37267a42d29fb4698efen,
          0x023a74b7eec73c64bf4c824bf7b15004252f23594d733e8b5e3df99057a1a402n
        ],
      },
      true,
    );
    await circuit.assertOut(witness, {
      out: [
        0x199f8c0ddd4fc19fbabcce889b860aea0840b953d7cb9897a24c03aa91321f30n,
        0x0488d23f20fce69d1c4f405f407987c50e605487002856e3d100a531fbef76b9n,
        0x263a13c6a63a36b7f83690126f3da9083932a4c310fc8273faf7fc7d4106a61bn,
        0x0c819a478981b1e3056aa6eacb7ca03c75df4ef8106dea2e920c6a30ee6eb295n,
        0x186a0cfec51820f97f3c64ca9a3f9fe84d728c3fc65298308db8c252e7763d2an,
        0x1de58fac635c3539da015d1ae4f775af54ca361c1bb33949146ebc92ec08ed05n,
        0x22cdb2286d74a378ab0e73265d8ea805e70487bab78b09624fae0111e72e7c17n,
        0x2a530cf261e7fa2c5610fd39d40e5363d238b66127bc4da42d3c3e41252f2746n,
        0x1435915959547c0b78257f1ceaddf744d24f20054b06901686a409f3fb7fdd02n,
        0x07d3142e793fc9b5d09fb56da48bdbaf9f3b0c0a60e65c22faea8abcd81fc68an,
        0x0b68ef91843d5f6a4d2c9274f6ddaa7bd6d78677502d1f2f6b220016fa569b92n,
        0x08473d26da0495891ba80a6b8a306c62d0084260690ccd9f5528a11bf25d18aan,
        0x2a6c3ab5f6ec231bfab2908184025cf5107cd9231d9e24bfe4676f93e4232528n,
        0x1e7b9102952e2c43c201ca85d589c2ee2f15a0fc44d3c1b14674044b4380f9bcn,
        0x3013bd07b9ff2be6b049d89513b0a65965980986383a64cd5dee34a1f5952917n,
        0x02bfe073ffc8a0c7cc5c2887333dfa9252df70099500399034bf491bb4cee13an
      ],
    });
    await circuit.checkConstraints(witness);
  });

  it("kat2", async () => {
    const witness = await circuit.calculateWitness(
      {
        in: [
          0x06b55384dd1f8432d7a1c51b5a6233347e1a01d6ccf71e4df8a97e6acfea494bn,
          0x1fb69c58f691a3f1a356ff552ff6472e1159c39eca1298ff6692ebf1221f21c0n,
          0x1b57c97bd134be1d2ad6ee333fe8f0edb31fd49777b62b78f8ae06c9fda9e4c0n,
          0x21147db82f08d38c7f0041c175f162a5c446de7358cfb084b0290da8eed8a6c7n,
          0x05d9295c10f3f4d7dc74e642e028503ee78745e579cbfa3f1aa69d51921e7f2an,
          0x08b7ed23161d249564b4fea706cfd77493bd09177077ff0e0c37c708c9137593n,
          0x0f6088e95561f9048541eac5e33fe33cb0a63531feea3fc00158956f4b3cc005n,
          0x231f9caba6d6a31d08fcec1da6c51624fe4563dffdc58f8874cb7e466c98dc50n,
          0x2da993dfb755a6c0c91a1253ee0edc67da208952f85ee94bd4748bfe07b7dcf4n,
          0x2b570a865c287eb3a020b7c5e8d6f9111d77624b77800061df004bc4840e69e9n,
          0x1073ae829bcf6044b33dc5879e01e2e85dc2f555704210a9dda4b1e1540ea2d3n,
          0x2ddd9346aadd09f246abac523816c59f66742633fff2f678556e08620e06b885n,
          0x05c56534c601f945933edbad83040a988aeb0c807891be8270571d942af99cf3n,
          0x26b1a1a534e46eb0e05289e4212b98b3c3c9f03ef2e6d26c85eeca1727ab8628n,
          0x0be9f33db4474cc99f5e835083737dde85a90a009b4d0d06afe4e0fc9230a2c1n,
          0x2bb8306d7c7ec521001e46c904e4761fe8336f9f1fe6ace0e1b5b8b1f473af55n
        ],
      },
      true,
    );
    await circuit.assertOut(witness, {
      out: [
        0x16870ef1a96a29aa6f91b1bc5f129795424bb1651dbfa593b6d67c45a015a325n,
        0x0b61b9d5c43ce81a4101b1a0cf6fe7e8f04af3f8c0af1c00661b89f70addd21an,
        0x26ed8fb676ab100a0bdbb5835e2ae78378dc93af64926e79ce6b4f67f40a9f2en,
        0x00afc78c94142cb0b383199db78411ca62cdfdc7642c262b50d82c9e4fd9bb2bn,
        0x100bff127ee5f3050e32522e45372280894ff84b2d73ef46f6b0a0fdccaf7ff9n,
        0x12414b2266a60acf06663ac7396712445676cd748589f272ce0fa143a503af20n,
        0x0bff1c82da41aeb1e380e8fda26480b010e054739d086bdb1236fd173166c032n,
        0x1e969d843bc4ab33ab1ee96d266d57be7c3a401660a5005f2e60378f20913a2fn,
        0x05848e0592a24fd0084d974d1ff4993a11a6b421ae3483bc3c875ab8902c52dan,
        0x17c202dbd22d4ac3d67ee56f02c9a7f707962224d1627bb40a6d780a6c166b09n,
        0x24e7c391772e5cc73fdc171313791b86d0463bc51e7208d4cfdaad7209bf8281n,
        0x0e206595d4d2e3ddb5eb38d58b0bdfa5099b4968a5239912f2840355c67c02ecn,
        0x26323fca2471db34936ee8ec5e48e20de20897de79170ef2411df3e438be8739n,
        0x0a4e622b558ef6d52c7cd3eaa99dfbef28625d7c6c97cabd4f4133c1595eb51dn,
        0x0c64abe0b9786cd362618b6f82c51759cb62844cf2dbb5d42c46f219dfe0f2acn,
        0x13be1ac72d72e5228b27c42bf32e0672c9cae552f97b89facb63b940e3f8eaccn
      ],
    });
    await circuit.checkConstraints(witness);
  });

  it("kat3", async () => {
    const witness = await circuit.calculateWitness(
      {
        in: [
          0x1cbaec6b27c2ebc5fdb69e1333798b981dcba6b38391557b7ac7b9b58d0f66c2n,
          0x189851071e8428ff3c8a96ac2ddb17ed0880c59988c3fee8dbfb62e195867fbdn,
          0x154f46875dfe815d037f8c06b2067e2b5cce8b77a9464a65ef2f6e665652b293n,
          0x210f88d63fa89778096ad54e6c0936d8f4d2453536f8f86b83ef5136ff2bc98bn,
          0x041e749316da9c8b5dd8897666b38053a14242ddc349d6f327eaa1e42ca5b570n,
          0x3021a34419c0bf5d11966d97e65789e3c614f59cb295c26b03139e59a053ad2dn,
          0x153dc912ce0688cca194db013cb5af4bf76dd0bcccb59803d6f47a626e838629n,
          0x145ef2786cf7f7dc887e77cfc268fe97d0ce8d3dbd62bf349dd28e8f2a77b008n,
          0x2d284de1cf215ed8a1cf131eacd8f192ba61c98383d2856696da2e670a5b23c1n,
          0x258f58bac3d054ad5f27eae324fa6fe5bba15ca5b84c93887aae8bbfb81488c1n,
          0x1312478dee9197edff1690bf7b350856b0f6960f0f4bd97b1aeb1866f0e6697bn,
          0x0633a7322a72259ae4201daf36ff2dfe2465227bf3a0d521b7b6aab723db6c1an,
          0x1d712e293228228b7f0b05446a2f4b27c8746711f59ed13bad7218be7aad98fbn,
          0x11745f000bdcf819b4ddbd377ce1d9eb7c326025159c771b055a7ac41e46eb72n,
          0x1fed00452611c593649df2ae4c8f83545a897e67ed2d9acb028f94d114810505n,
          0x2525294c748d48ab2b1f30a660c134608427b3be80a4d72ab723b17d25ed5d52n
        ],
      },
      true,
    );
    await circuit.assertOut(witness, {
      out: [
        0x2b20cdac71d0877cd2ca763fd3b97286a7c6958b9032ff694f7f9a0fab0e6195n,
        0x23aceba4409f64808b72fc225720057fb9bf610fec117d3f981c8743884fcbeen,
        0x08662d7bfef474d3ead01bf3c94fe4ef10e70baf5f6d1cf3e07ce4b6853f66acn,
        0x0bdb073e51bde89f93a65cbfd98e80ea7f091299ea93eb6cdfadfcec86757077n,
        0x2c78c4dd3279322e16ade03e9c9391b46933d39d5d38d12e6f390b50591ca9f8n,
        0x2d4d8765fb401a33b156176d07abbee282c9e7f5a87a1b6e288d5dca2111d909n,
        0x16a8cf0704071589af3113d86f0b3d0911a56504392015f5adca2c02cc73ccc5n,
        0x055f44503d034bfe2a2699bedbd15681610407737fd8dfffc1513fe10f39b289n,
        0x087742e5845e1b2c965e7f2bc5b408cee716df9c019fb7a770138d5d847e02fan,
        0x178cbed7704d0d1da3751950067f811e807ffd9c932a7e8ca5d640a41f596f04n,
        0x1bd115492e405f8d46cfd0f60404ad75497aed79a906ec85a29e396f69936ef0n,
        0x27a5f932a5d1078475096c225559697ff8ef6b1a99dec900d802042b71b41987n,
        0x25f29fa8ce03cd5248cfcf4485993eb06d6c0f3223a9ee97af994688bc6d8208n,
        0x0120aea7c2e569bd1cd3ff49623c9d71e0b98e569659802a6ff1d93dae4e4ad0n,
        0x1b8c8cfe6aa076226c4e38ea6ce8407e1e1180720c6c033e041822a809172253n,
        0x20676fd2b77c0704dbf127d2d57e4f3bc12f91a8097c3e99b7a38e9b2e600239n
      ],
    });
    await circuit.checkConstraints(witness);
  });
});
